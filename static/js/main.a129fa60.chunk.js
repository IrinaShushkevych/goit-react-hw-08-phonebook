(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{25:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var r=n(30),a={position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"},c=function(e){r.b.error(e,a)},o=function(e){r.b.warn(e,a)}},27:function(e,t,n){"use strict";var r=n(40),a=n.n(r),c=n(1);t.a=function(e){var t=e.title,n=void 0===t?"":t,r=e.children;return Object(c.jsxs)("div",{className:a.a.container,children:[n&&Object(c.jsx)("h2",{className:a.a.title,children:n}),r]})}},35:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d}));var r=n(6),a=n(37),c=n(16),o=Object(a.a)({reducerPath:"contacts",baseQuery:Object(c.d)({baseUrl:"https://connections-api.herokuapp.com/contacts",prepareHeaders:function(e,t){var n=(0,t.getState)().auth.token;return n&&e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["contacts"],endpoints:function(e){return{getContacts:e.query({query:function(){return"/"},providesTags:function(e){return e?[].concat(Object(r.a)(e.map((function(e){return{type:"contacts",id:e.id}}))),["contacts"]):["contacts"]}}),addContact:e.mutation({query:function(e){return{url:"/",method:"POST",body:e}},invalidatesTags:["contacts"]}),deleteContact:e.mutation({query:function(e){return{url:"/".concat(e),method:"DELETE"}},invalidatesTags:function(e){return e?[{type:"contacts",id:e.id}]:["contacts"]}}),editContact:e.mutation({query:function(e){var t=e.contact,n=e.id;return{url:"/".concat(n),method:"PATCH",body:t}},invalidatesTags:function(e){return e?Object(r.a)(e.map((function(e){return{type:"contacts",id:e.id}}))):["contacts"]}})}}}),s=o.useGetContactsQuery,i=o.useAddContactMutation,u=o.useDeleteContactMutation,d=o.useEditContactMutation},40:function(e,t,n){e.exports={container:"Container_container__YdtW5",title:"Container_title__UrP9o"}},41:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=function(e){var t,n,r;return null!==(t=null===e||void 0===e||null===(n=e.auth)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.name)&&void 0!==t?t:""},a=function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.auth)||void 0===n?void 0:n.token)&&void 0!==t?t:""}},45:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.createAction)("filter")},61:function(e,t,n){},62:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r,a,c,o=n(0),s=n.n(o),i=n(26),u=n.n(i),d=n(11),l=n(20),b=(n(60),n(61),n(3)),j=(n(62),n(7)),p=n(41),h=n(9),O=n(4),f=n.n(O),m=n(37),g=n(16),x=Object(m.a)({reducerPath:"users",baseQuery:Object(g.d)({baseUrl:"https://connections-api.herokuapp.com/users",prepareHeaders:function(e,t){var n=(0,t.getState)().auth.token;return n&&e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["user"],endpoints:function(e){return{registerUser:e.mutation({queryFn:function(){var e=Object(h.a)(f.a.mark((function e(t,n,r,a){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({url:"/signup",method:"POST",body:t}).then((function(e){if(e.error)switch(e.error.status){case 400:return{error:{status:400,data:"Wrong email or passwird"}};case 404:return{error:{status:404,data:"Not found"}};case 500:return{error:{status:500,data:"Servers error"}};default:return e.error}return e})).catch((function(e){return e}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),invalidatesTags:["user"]}),loginUser:e.mutation({queryFn:function(){var e=Object(h.a)(f.a.mark((function e(t,n,r,a){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({url:"/login",method:"POST",body:t}).then((function(e){if(e.error)switch(e.error.status){case 400:return{error:{status:400,data:"Wrong email or passwird"}};case 404:return{error:{status:404,data:"Not found"}};default:return e.error}return e})).catch((function(e){return e}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),invalidatesTags:["user"]}),logoutUser:e.mutation({queryFn:function(){var e=Object(h.a)(f.a.mark((function e(t,n,r,a){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({url:"/logout",method:"POST"}).then((function(e){if(e.error)switch(e.error.status){case 400:return{error:{status:400,data:"Wrong email or passwird"}};case 404:return{error:{status:404,data:"Not found"}};default:return e.error}return e})).catch((function(e){return e}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()})}}}),v=x.useRegisterUserMutation,y=x.useLoginUserMutation,w=x.useLogoutUserMutation,k=n(27),S=n(25),C=n(14),q=n(15),P=q.a.ul(r||(r=Object(C.a)(["\n  display: flex;\n  justify-content: flex-end;\n  margin-left: auto;\n"]))),T=q.a.li(a||(a=Object(C.a)(["\n  padding: 20px 20px;\n  &:not(last-child) {\n    margin-right: 20px;\n  }\n"]))),E=q.a.div(c||(c=Object(C.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n"]))),F=n(1);function L(){var e=Object(d.e)(p.b),t=w(),n=Object(j.a)(t,2),r=n[0],a=n[1].error,c=Object(b.g)();return console.log(c),console.log(c.pathname),Object(o.useEffect)((function(){a&&Object(S.a)(a)}),[a]),Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(k.a,{children:Object(F.jsxs)(E,{children:[e&&!c.pathname.includes("add")&&Object(F.jsx)(l.b,{to:"".concat(c.pathname,"/add"),children:"Add contact"}),Object(F.jsx)(P,{children:e?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(T,{children:["Hello, ",e]}),Object(F.jsx)(T,{children:Object(F.jsx)(l.b,{to:"/",onClick:function(){r()},children:"LogOut"})})]}):Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(T,{children:Object(F.jsx)(l.b,{to:"register",children:"Register"})}),Object(F.jsx)(T,{children:Object(F.jsx)(l.b,{to:"login",children:"LogIn"})})]})})]})}),Object(F.jsx)(b.b,{})]})}var I,U,M,A,N=n(13),R=n(38),_=q.a.form(I||(I=Object(C.a)(["\n  width: 400px;\n  margin-left: auto;\n  margin-right: auto;\n  padding: 20px;\n"]))),z=q.a.label(U||(U=Object(C.a)(["\n  position: relative;\n  display: block;\n  margin-bottom: 30px;\n  padding-top: 20px;\n"]))),H=q.a.input(M||(M=Object(C.a)(["\n  display: block;\n  padding: 4px 20px;\n  width: 100%;\n  border-style: none;\n  border-bottom-style: groove;\n  border-bottom: 3px solid wheat;\n  background: transparent;\n  outline: none;\n  color: white;\n"]))),B=q.a.span(A||(A=Object(C.a)(["\n  display: block;\n  position: absolute;\n  bottom: 8px;\n  left: 20px;\n  font-size: 18px;\n  transition: 250ms linear;\n\n  input:focus + & {\n    bottom: 80%;\n  }\n\n  input:placeholder-shown + & {\n    background-color: red;\n  }\n\n  input:not(:placeholder-shown).input:not(:focus) + & {\n    bottom: 80%;\n  }\n"])));function W(){var e,t,n,r=Object(o.useState)(null!==(e=localStorage.getItem("email"))&&void 0!==e?e:""),a=Object(j.a)(r,2),c=a[0],s=a[1],i=Object(o.useState)(""),u=Object(j.a)(i,2),d=u[0],l=u[1],p=Object(R.a)(),O=p.register,m=p.handleSubmit,g=p.formState.errors,x=Object(b.h)(),v=y(),w=Object(j.a)(v,2),k=w[0],C=w[1],q=C.isLoading,P=C.isSuccess,T=C.error,E=function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k({email:c,password:d});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(e){var t=e.target.value;switch(e.target.name){case"email":s(t),localStorage.setItem("email",t);break;case"password":l(t);break;default:return}};return Object(o.useEffect)((function(){T&&Object(S.a)(T.data)}),[T]),Object(o.useEffect)((function(){P&&(s(""),l(""),x("/contacts"))}),[P,x]),Object(F.jsxs)(F.Fragment,{children:[q&&Object(F.jsx)("h3",{children:"Loading...."}),Object(F.jsxs)(_,{onSubmit:m(E),children:[Object(F.jsxs)(z,{children:[Object(F.jsx)(H,Object(N.a)(Object(N.a)({type:"email"},O("email",{required:!0})),{},{onChange:L,value:c})),Object(F.jsx)(B,{children:"E-mail"}),"required"===(null===(t=g.email)||void 0===t?void 0:t.type)&&"Email is required"]}),Object(F.jsxs)(z,{children:[Object(F.jsx)(H,Object(N.a)(Object(N.a)({type:"password"},O("password",{required:!0})),{},{onChange:L,value:d})),Object(F.jsx)(B,{children:"Password"}),"required"===(null===(n=g.password)||void 0===n?void 0:n.type)&&"Password is required"]}),Object(F.jsx)("button",{type:"button",onClick:function(){x("/")},children:"Cancel"}),Object(F.jsx)("button",{type:"submit",children:"Log in"})]})]})}function Q(){return Object(F.jsxs)(k.a,{children:[Object(F.jsx)("h2",{children:"Form Login"}),Object(F.jsx)(W,{})]})}function D(){var e,t,n,r,a=Object(o.useState)(null!==(e=sessionStorage.getItem("name"))&&void 0!==e?e:""),c=Object(j.a)(a,2),s=c[0],i=c[1],u=Object(o.useState)(null!==(t=sessionStorage.getItem("email"))&&void 0!==t?t:""),d=Object(j.a)(u,2),l=d[0],p=d[1],O=Object(o.useState)(""),m=Object(j.a)(O,2),g=m[0],x=m[1],y=Object(R.a)(),w=y.register,k=y.handleSubmit,C=y.formState.errors,q=Object(b.h)(),P=v(),T=Object(j.a)(P,2),E=T[0],L=T[1],I=L.isLoading,U=L.error,M=L.isSuccess,A=function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E({name:s,email:l,password:g});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){var t=e.target.value;switch(e.target.name){case"name":i(t),sessionStorage.setItem("name",t);break;case"email":p(t),sessionStorage.setItem("email",t);break;case"password":x(t);break;default:return}};return Object(o.useEffect)((function(){U&&Object(S.a)(U.data)}),[U]),Object(o.useEffect)((function(){M&&(i(""),p(""),x(""),sessionStorage.removeItem("name"),sessionStorage.removeItem("email"),q("/contacts"))}),[M]),Object(F.jsxs)(F.Fragment,{children:[I&&Object(F.jsx)("h3",{children:"Loading...."}),Object(F.jsxs)("form",{onSubmit:k(A),children:[Object(F.jsxs)("label",{children:["name",Object(F.jsx)("input",Object(N.a)(Object(N.a)({},w("name")),{},{value:s,onChange:_}))]}),Object(F.jsxs)("label",{children:["email",Object(F.jsx)("input",Object(N.a)(Object(N.a)({type:"email"},w("email",{required:!0})),{},{onChange:_,value:l})),"required"===(null===(n=C.email)||void 0===n?void 0:n.type)&&"Email is required"]}),Object(F.jsxs)("label",{children:["password",Object(F.jsx)("input",Object(N.a)(Object(N.a)({type:"password"},w("password",{required:!0})),{},{onChange:_,value:g})),"required"===(null===(r=C.password)||void 0===r?void 0:r.type)&&"Password is required"]}),Object(F.jsx)("button",{type:"button",onClick:function(){sessionStorage.removeItem("name"),sessionStorage.removeItem("email"),q("/")},children:"Cancel"}),Object(F.jsx)("button",{type:"submit",children:"Register"})]})]})}function J(){return Object(F.jsxs)(k.a,{children:[Object(F.jsx)("h2",{children:"Form Register"}),Object(F.jsx)(D,{})]})}var G=Object(o.lazy)((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,102))}));function Y(){return Object(F.jsx)("div",{className:"App",children:Object(F.jsx)(o.Suspense,{fallback:Object(F.jsx)("p",{children:"Loading...."}),children:Object(F.jsxs)(b.e,{children:[Object(F.jsxs)(b.c,{path:"/",element:Object(F.jsx)(L,{}),children:[Object(F.jsx)(b.c,{path:"login",element:Object(F.jsx)(Q,{})}),Object(F.jsx)(b.c,{path:"register",element:Object(F.jsx)(J,{})}),Object(F.jsx)(b.c,{path:"contacts/*",element:Object(F.jsx)(G,{})})]}),Object(F.jsx)(b.c,{path:"*",element:Object(F.jsx)(b.a,{to:"/"})})]})})})}var K,V=n(12),X=n(6),Z=n(2),$=n(49),ee=n(22),te=n(48),ne=n.n(te),re=(n(67),n(35)),ae=n(45),ce=Object(Z.createReducer)("",Object(V.a)({},ae.a,(function(e,t){return t.payload}))),oe=Object(Z.createSlice)({name:"auth",initialState:{token:null,user:null},extraReducers:function(e){e.addMatcher(x.endpoints.registerUser.matchFulfilled,(function(e,t){var n=t.payload;e.token=n.token,e.user=n.user})),e.addMatcher(x.endpoints.loginUser.matchFulfilled,(function(e,t){var n=t.payload;e.token=n.token,e.user=n.user})),e.addMatcher(x.endpoints.logoutUser.matchFulfilled,(function(e,t){t.payload;e.token=null,e.user=null}))}}),se={key:"root",storage:ne.a},ie=Object(ee.g)(se,oe.reducer),ue=Object(Z.configureStore)({reducer:(K={},Object(V.a)(K,x.reducerPath,x.reducer),Object(V.a)(K,re.a.reducerPath,re.a.reducer),Object(V.a)(K,oe.name,ie),Object(V.a)(K,"filter",ce),K),middleware:function(e){return[].concat(Object(X.a)(e({serializableCheck:{ignoredActions:[ee.a,ee.f,ee.b,ee.c,ee.d,ee.e]}})),[re.a.middleware,x.middleware,!1])},devTools:!1});Object($.setupListeners)(ue.dispatch);var de=Object(ee.h)(ue),le=n(30),be=(n(70),n(50));u.a.render(Object(F.jsx)(s.a.StrictMode,{children:Object(F.jsx)(d.a,{store:ue,children:Object(F.jsxs)(be.a,{loader:null,persistor:de,children:[Object(F.jsx)(l.a,{children:Object(F.jsx)(Y,{})}),Object(F.jsx)(le.a,{})]})})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.a129fa60.chunk.js.map