(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{19:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var r=n(30),a={position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"},c=function(e){r.b.error(e,a)},o=function(e){r.b.warn(e,a)}},27:function(e,t,n){"use strict";var r=n(39),a=n.n(r),c=n(1);t.a=function(e){var t=e.title,n=void 0===t?"":t,r=e.children,o=e.size,s=void 0===o?"small":o;return Object(c.jsxs)("div",{className:s&&"small"!==s?a.a.containerFull:a.a.container,children:[n&&Object(c.jsx)("h2",{className:a.a.title,children:n}),r]})}},35:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(6),a=n(37),c=n(16),o=Object(a.a)({reducerPath:"contacts",baseQuery:Object(c.d)({baseUrl:"https://connections-api.herokuapp.com/contacts",prepareHeaders:function(e,t){var n=(0,t.getState)().auth.token;return n&&e.set("authorization","Bearer ".concat(n)),e}}),keepUnusedDataFor:0,tagTypes:["contacts"],endpoints:function(e){return{getContacts:e.query({query:function(){return"/"},providesTags:function(e){return e?[].concat(Object(r.a)(e.map((function(e){return{type:"contacts",id:e.id}}))),["contacts"]):["contacts"]}}),addContact:e.mutation({query:function(e){return{url:"/",method:"POST",body:e}},invalidatesTags:["contacts"]}),deleteContact:e.mutation({query:function(e){return{url:"/".concat(e),method:"DELETE"}},invalidatesTags:function(e){return e?[{type:"contacts",id:e.id}]:["contacts"]}}),editContact:e.mutation({query:function(e){var t=e.contact,n=e.id;return{url:"/".concat(n),method:"PATCH",body:t}},invalidatesTags:function(e){return e?Object(r.a)(e.map((function(e){return{type:"contacts",id:e.id}}))):["contacts"]}})}}}),s=(o.endpoints.getContacts.useQuerySubscription,o.useGetContactsQuery),i=o.useAddContactMutation,u=o.useDeleteContactMutation,l=o.useEditContactMutation},39:function(e,t,n){e.exports={container:"Container_container__3RIox",containerFull:"Container_containerFull__1DSOm",title:"Container_title__1Jp2Q"}},41:function(e,t,n){e.exports={container:"ContainerPage_container__3qVA2",title:"ContainerPage_title__1oJEv"}},45:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.createAction)("filter")},61:function(e,t,n){},62:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r,a,c,o=n(0),s=n.n(o),i=n(26),u=n.n(i),l=n(9),d=n(20),j=(n(60),n(61),n(3)),b=(n(62),n(7)),h=function(e){var t,n,r;return null!==(t=null===e||void 0===e||null===(n=e.auth)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.name)&&void 0!==t?t:null},p=function(e){var t;return!(null===e||void 0===e||null===(t=e.auth)||void 0===t||!t.token)},O=n(13),f=n(4),m=n.n(f),g=n(37),x=n(16),v=Object(g.a)({reducerPath:"users",baseQuery:Object(x.d)({baseUrl:"https://connections-api.herokuapp.com/users",prepareHeaders:function(e,t){var n=(0,t.getState)().auth.token;return n&&e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["user"],endpoints:function(e){return{registerUser:e.mutation({queryFn:function(){var e=Object(O.a)(m.a.mark((function e(t,n,r,a){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({url:"/signup",method:"POST",body:t}).then((function(e){if(e.error)switch(e.error.status){case 400:return{error:{status:400,data:"Wrong email or passwird"}};case 404:return{error:{status:404,data:"Not found"}};case 500:return{error:{status:500,data:"Servers error"}};default:return e.error}return e})).catch((function(e){return e}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),invalidatesTags:["user"]}),loginUser:e.mutation({queryFn:function(){var e=Object(O.a)(m.a.mark((function e(t,n,r,a){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({url:"/login",method:"POST",body:t}).then((function(e){if(e.error)switch(e.error.status){case 400:return{error:{status:400,data:"Wrong email or passwird"}};case 404:return{error:{status:404,data:"Not found"}};default:return e.error}return e})).catch((function(e){return e}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),invalidatesTags:["user"]}),logoutUser:e.mutation({queryFn:function(){var e=Object(O.a)(m.a.mark((function e(t,n,r,a){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({url:"/logout",method:"POST"}).then((function(e){if(e.error)switch(e.error.status){case 401:return{error:{status:401,data:"No authorization"}};case 404:return{error:{status:404,data:"Not found"}};case 500:return{error:{status:500,data:"Servers error"}};default:return e.error}return e})).catch((function(e){return e}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()}),getUser:e.query({queryFn:function(){var e=Object(O.a)(m.a.mark((function e(t,n,r,a){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.getState().auth.token){e.next=2;break}return e.abrupt("return",{data:{name:null,email:null}});case 2:return e.next=4,a({url:"/current"}).then((function(e){if(e.error)switch(e.error.status){case 401:return{error:{status:401,data:"No authorization"}};case 404:return{error:{status:404,data:"Not found"}};default:return e.error}return e})).catch((function(e){return e}));case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()})}}}),y=v.useRegisterUserMutation,w=v.useLoginUserMutation,k=v.useLogoutUserMutation,S=v.useGetUserQuery,C=n(27),q=n(19),F=n(10),L=n(11),T=L.a.ul(r||(r=Object(F.a)(["\n  display: flex;\n  justify-content: flex-end;\n  margin-left: auto;\n"]))),P=L.a.li(a||(a=Object(F.a)(["\n  padding: 20px 20px;\n  &:not(last-child) {\n    margin-right: 20px;\n  }\n"]))),E=L.a.div(c||(c=Object(F.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n"]))),U=n(1);function _(){var e=Object(l.e)(h),t=k(),n=Object(b.a)(t,2),r=n[0],a=n[1].error,c=Object(j.g)();return Object(o.useEffect)((function(){a&&Object(q.a)(a)}),[a]),Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(C.a,{size:"full",children:Object(U.jsxs)(E,{children:[e&&!c.pathname.includes("add")&&Object(U.jsx)(d.b,{to:"".concat(c.pathname,"/add"),children:"Add contact"}),Object(U.jsx)(T,{children:e?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)(P,{children:["Hello, ",e]}),Object(U.jsx)(P,{children:Object(U.jsx)(d.b,{to:"/",onClick:function(){r()},children:"LogOut"})})]}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(P,{children:Object(U.jsx)(d.b,{to:"register",children:"Register"})}),Object(U.jsx)(P,{children:Object(U.jsx)(d.b,{to:"login",children:"LogIn"})})]})})]})}),Object(U.jsx)(j.b,{})]})}var N,z,I,M,A,R,Q=n(15),H=n(38),B=L.a.form(N||(N=Object(F.a)(["\n  width: 400px;\n  max-width: 100%;\n  margin-left: auto;\n  margin-right: auto;\n  padding: 20px;\n"]))),D=L.a.label(z||(z=Object(F.a)(["\n  position: relative;\n  width: 100%;\n  display: block;\n  margin-bottom: 30px;\n  padding-top: 20px;\n"]))),J=L.a.input(I||(I=Object(F.a)(["\n  display: block;\n  padding: 4px 20px;\n  width: 100%;\n\n  border-style: none;\n  border-bottom-style: groove;\n  border-bottom: 3px solid wheat;\n  background: transparent;\n  outline: none;\n  color: white;\n"]))),V=L.a.span(M||(M=Object(F.a)(["\n  display: block;\n  position: absolute;\n  bottom: 8px;\n  left: 20px;\n  font-size: 18px;\n  pointer-events: none;\n  transition: 250ms linear;\n\n  input:focus + &,\n  input:not(:placeholder-shown) + & {\n    bottom: 80%;\n  }\n"]))),Z=L.a.button(A||(A=Object(F.a)(["\n  padding: 10px;\n  border: 1px solid wheat;\n  border-radius: 10px;\n  background-color: transparent;\n  color: wheat;\n\n  &:not(:last-child) {\n    margin-right: 30px;\n  }\n\n  &:hover,\n  &:focus {\n    color: rgb(6, 255, 247);\n    border-color: rgb(6, 255, 247);\n  }\n"]))),G=L.a.span(R||(R=Object(F.a)(["\n  position: absolute;\n  top: 108%;\n  left: 20%;\n  color: rgb(242, 111, 111);\n  font-size: 14px;\n"])));function W(){var e,t,n,r,a=Object(o.useState)(null!==(e=localStorage.getItem("email"))&&void 0!==e?e:""),c=Object(b.a)(a,2),s=c[0],i=c[1],u=Object(o.useState)(""),l=Object(b.a)(u,2),d=l[0],h=l[1],p=Object(H.a)(),O=p.register,f=p.handleSubmit,m=p.setValue,g=p.formState.errors,x=Object(j.h)(),v=w(),y=Object(b.a)(v,2),k=y[0],S=y[1],C=S.isLoading,F=S.isSuccess,L=S.error,T=function(e){var t=e.target.value;switch(e.target.name){case"email":i(t),m("email",t),localStorage.setItem("email",t);break;case"password":h(t),m("password",t);break;default:return}};return Object(o.useEffect)((function(){L&&Object(q.a)(L.data)}),[L]),Object(o.useEffect)((function(){F&&(i(""),h(""),x("/contacts"))}),[F,x]),Object(U.jsxs)(U.Fragment,{children:[C&&Object(U.jsx)("h3",{children:"Loading...."}),Object(U.jsxs)(B,{onSubmit:f((function(e){k({email:s,password:d})})),children:[Object(U.jsxs)(D,{htmlFor:"email",children:[Object(U.jsx)(J,Object(Q.a)(Object(Q.a)({},O("email",{required:!0})),{},{type:"email",onChange:T,value:s,placeholder:" "})),Object(U.jsx)(V,{children:"E-mail"}),"required"===(null===g||void 0===g||null===(t=g.email)||void 0===t?void 0:t.type)&&Object(U.jsx)(G,{children:"Email is required"})]}),Object(U.jsxs)(D,{htmlFor:"password",children:[Object(U.jsx)(J,Object(Q.a)(Object(Q.a)({},O("password",{required:!0,minLength:6})),{},{type:"password",onChange:T,value:d,placeholder:" "})),Object(U.jsx)(V,{children:"Password"}),"required"===(null===g||void 0===g||null===(n=g.password)||void 0===n?void 0:n.type)&&Object(U.jsx)(G,{children:"Password is required"}),"minLength"===(null===(r=g.password)||void 0===r?void 0:r.type)&&Object(U.jsx)(G,{children:"Password is short"})]}),Object(U.jsx)(Z,{type:"submit",children:"Log in"}),Object(U.jsx)(Z,{type:"button",onClick:function(){x("/")},children:"Cancel"})]})]})}function $(){return Object(U.jsxs)(C.a,{children:[Object(U.jsx)("h2",{children:"Form Login"}),Object(U.jsx)(W,{})]})}function K(){var e,t,n,r,a,c,s=Object(o.useState)(null!==(e=sessionStorage.getItem("name"))&&void 0!==e?e:""),i=Object(b.a)(s,2),u=i[0],l=i[1],d=Object(o.useState)(null!==(t=sessionStorage.getItem("email"))&&void 0!==t?t:""),h=Object(b.a)(d,2),p=h[0],f=h[1],g=Object(o.useState)(""),x=Object(b.a)(g,2),v=x[0],w=x[1],k=Object(H.a)(),S=k.register,C=k.handleSubmit,F=k.setValue,L=k.formState.errors,T=Object(j.h)(),P=y(),E=Object(b.a)(P,2),_=E[0],N=E[1],z=N.isLoading,I=N.error,M=N.isSuccess,A=function(){var e=Object(O.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_({name:u,email:p,password:v});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(e){var t=e.target.value;switch(e.target.name){case"name":l(t),F("name",t),sessionStorage.setItem("name",t);break;case"email":f(t),F("email",t),sessionStorage.setItem("email",t);break;case"password":w(t),F("password",t);break;default:return}};return Object(o.useEffect)((function(){I&&Object(q.a)(I.data)}),[I]),Object(o.useEffect)((function(){M&&(l(""),f(""),w(""),sessionStorage.removeItem("name"),sessionStorage.removeItem("email"),T("/contacts"))}),[M]),Object(U.jsxs)(U.Fragment,{children:[z&&Object(U.jsx)("h3",{children:"Loading...."}),Object(U.jsxs)(B,{onSubmit:C(A),children:[Object(U.jsxs)(D,{children:[Object(U.jsx)(J,Object(Q.a)(Object(Q.a)({},S("name",{required:!0,pattern:/^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$/})),{},{value:u,onChange:R,placeholder:" "})),Object(U.jsx)(V,{children:"Name"}),"pattern"===(null===L||void 0===L||null===(n=L.name)||void 0===n?void 0:n.type)&&Object(U.jsx)(G,{children:"Error in name"})]}),Object(U.jsxs)(D,{children:[Object(U.jsx)(J,Object(Q.a)(Object(Q.a)({type:"email"},S("email",{required:!0})),{},{onChange:R,value:p,placeholder:" "})),Object(U.jsx)(V,{children:"E-mail"}),"required"===(null===L||void 0===L||null===(r=L.email)||void 0===r?void 0:r.type)&&Object(U.jsx)(G,{children:"Email is required"})]}),Object(U.jsxs)(D,{children:[Object(U.jsx)(J,Object(Q.a)(Object(Q.a)({type:"password"},S("password",{required:!0,minLength:6})),{},{onChange:R,value:v,placeholder:" "})),Object(U.jsx)(V,{children:"Password"}),"required"===(null===(a=L.password)||void 0===a?void 0:a.type)&&Object(U.jsx)(G,{children:"Password is required"}),"minLength"===(null===(c=L.password)||void 0===c?void 0:c.type)&&Object(U.jsx)(G,{children:"Password is short"})]}),Object(U.jsx)(Z,{type:"submit",children:"Register"}),Object(U.jsx)(Z,{type:"button",onClick:function(){sessionStorage.removeItem("name"),sessionStorage.removeItem("email"),T("/")},children:"Cancel"})]})]})}function X(){return Object(U.jsxs)(C.a,{children:[Object(U.jsx)("h2",{children:"Form Register"}),Object(U.jsx)(K,{})]})}function Y(e){var t=e.redirectTo,n=e.restricted,r=void 0!==n&&n,a=e.element,c=Object(l.e)(p);return!t&&r?(Object(q.a)("No path for redirect"),Object(U.jsx)(j.a,{to:"/"})):Object(U.jsx)(U.Fragment,{children:c&&r?Object(U.jsx)(j.a,{to:t}):a})}function ee(e){var t=e.element,n=e.redirectTo,r=Object(l.e)(p);return n?Object(U.jsx)(U.Fragment,{children:r?t:Object(U.jsx)(j.a,{to:n})}):(Object(q.a)("No path for redirect"),Object(U.jsx)(j.a,{to:"/"}))}var te=Object(o.lazy)((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,102))}));function ne(){var e=S().error;return Object(o.useEffect)((function(){e&&Object(q.a)(e.data)}),[e]),Object(U.jsx)("div",{className:"App",children:Object(U.jsx)(o.Suspense,{fallback:Object(U.jsx)("p",{children:"Loading...."}),children:Object(U.jsxs)(j.e,{children:[Object(U.jsxs)(j.c,{path:"/",element:Object(U.jsx)(_,{}),children:[Object(U.jsx)(j.c,{path:"login",element:Object(U.jsx)(Y,{element:Object(U.jsx)($,{}),redirectTo:"/contacts",restricted:!0})}),Object(U.jsx)(j.c,{path:"register",element:Object(U.jsx)(Y,{element:Object(U.jsx)(X,{}),redirectTo:"/contacts",restricted:!0})}),Object(U.jsx)(j.c,{path:"contacts/*",element:Object(U.jsx)(ee,{element:Object(U.jsx)(te,{}),redirectTo:"/login"})})]}),Object(U.jsx)(j.c,{path:"*",element:Object(U.jsx)(j.a,{to:"/"})})]})})})}var re,ae=n(14),ce=n(6),oe=n(2),se=n(49),ie=n(23),ue=n(48),le=n.n(ue),de=(n(67),n(35)),je=n(45),be=Object(oe.createReducer)("",Object(ae.a)({},je.a,(function(e,t){return t.payload}))),he=Object(oe.createSlice)({name:"auth",initialState:{token:null,user:null},extraReducers:function(e){e.addMatcher(v.endpoints.registerUser.matchFulfilled,(function(e,t){var n=t.payload;e.token=n.token,e.user=n.user,e.isLogged=!0})),e.addMatcher(v.endpoints.loginUser.matchFulfilled,(function(e,t){var n=t.payload;e.token=n.token,e.user=n.user,e.isLogged=!0})),e.addMatcher(v.endpoints.logoutUser.matchFulfilled,(function(e){e.token=null,e.user=null,e.isLogged=!1})),e.addMatcher(v.endpoints.getUser.matchFulfilled,(function(e,t){var n=t.payload;e.user=n,e.isLogged=!0}))}}),pe={key:"auth",storage:le.a,whitelist:["token"]},Oe=Object(ie.g)(pe,he.reducer),fe=Object(oe.configureStore)({reducer:(re={},Object(ae.a)(re,v.reducerPath,v.reducer),Object(ae.a)(re,de.a.reducerPath,de.a.reducer),Object(ae.a)(re,he.name,Oe),Object(ae.a)(re,"filter",be),re),middleware:function(e){return[].concat(Object(ce.a)(e({serializableCheck:{ignoredActions:[ie.a,ie.f,ie.b,ie.c,ie.d,ie.e]}})),[de.a.middleware,v.middleware])},devTools:!1});Object(se.setupListeners)(fe.dispatch);var me=Object(ie.h)(fe),ge=n(30),xe=(n(70),n(50)),ve=n(41),ye=n.n(ve);function we(e){var t=e.title,n=void 0===t?"":t,r=e.children;return Object(U.jsxs)("div",{className:ye.a.container,children:[n&&Object(U.jsx)("h2",{className:ye.a.title,children:n}),r]})}u.a.render(Object(U.jsx)(s.a.StrictMode,{children:Object(U.jsx)(l.a,{store:fe,children:Object(U.jsxs)(xe.a,{loader:null,persistor:me,children:[Object(U.jsx)(d.a,{children:Object(U.jsx)(we,{children:Object(U.jsx)(ne,{})})}),Object(U.jsx)(ge.a,{})]})})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.abd7a6eb.chunk.js.map