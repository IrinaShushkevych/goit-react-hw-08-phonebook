(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{17:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return o}));var r=function(e){return e.users.name},a=function(e){return e.users.error},c=function(e){return e.users.isLoading},o=function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.users)||void 0===n?void 0:n.token)&&void 0!==t?t:""}},23:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var r=n(28),a={position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark"},c=function(e){r.b.error(e,a)},o=function(e){r.b.warn(e,a)}},25:function(e,t,n){"use strict";var r=n(39),a=n.n(r),c=n(2);t.a=function(e){var t=e.title,n=void 0===t?"":t,r=e.children;return Object(c.jsxs)("div",{className:a.a.container,children:[n&&Object(c.jsx)("h2",{className:a.a.title,children:n}),r]})}},33:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d}));var r=n(7),a=n(48),c=n(14),o=Object(a.a)({reducerPath:"contacts",baseQuery:Object(c.d)({baseUrl:"https://connections-api.herokuapp.com/contacts"}),tagTypes:["contacts"],endpoints:function(e){return{getContacts:e.query({query:function(e){var t=e.token;return{url:"/",headers:{Authorization:"Bearer ".concat(t)}}},providesTags:function(e){return e?[].concat(Object(r.a)(e.map((function(e){return{type:"contacts",id:e.id}}))),["contacts"]):["contacts"]}}),addContact:e.mutation({query:function(e){var t=e.contact,n=e.token;return{url:"/",method:"POST",headers:{Authorization:"Bearer ".concat(n)},body:t}},invalidatesTags:["contacts"]}),deleteContact:e.mutation({query:function(e){var t=e.id,n=e.token;return{url:"/".concat(t),method:"DELETE",headers:{Authorization:"Bearer ".concat(n)}}},invalidatesTags:function(e){return e?[{type:"contacts",id:e.id}]:["contacts"]}}),editContact:e.mutation({query:function(e){var t=e.contact,n=e.id,r=e.token;return{url:"/".concat(n),method:"PATCH",headers:{Authorization:"Bearer ".concat(r)},body:t}},invalidatesTags:function(e){return e?Object(r.a)(e.map((function(e){return{type:"contacts",id:e.id}}))):["contacts"]}})}}}),i=o.useGetContactsQuery,s=o.useAddContactMutation,u=o.useDeleteContactMutation,d=o.useEditContactMutation},39:function(e,t,n){e.exports={container:"Container_container__YdtW5",title:"Container_title__UrP9o"}},44:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),a=Object(r.createAction)("filter")},61:function(e,t,n){},62:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r,a,c=n(0),o=n.n(c),i=n(24),s=n.n(i),u=n(6),d=n(19),l=(n(60),n(61),n(3)),j=(n(62),n(17)),b=n(25),O=n(13),h=n(5),f=n.n(h),m=n(1),p="https://connections-api.herokuapp.com/users",g=function(e){return fetch("".concat(p,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){switch(e.status){case 201:return e.json();case 400:throw Error("Wrong name, login or password");case 404:throw Error("Not found");case 500:throw Error("Servers error");default:throw Error(e.statusText)}}))},v=function(e){return fetch("".concat(p,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){switch(e.status){case 200:return e.json();case 400:throw Error("Wrong login or password");case 404:throw Error("Not found");default:throw Error(e.statusText)}}))},x=function(e){return fetch("".concat(p,"/logout"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){switch(e.status){case 200:return e.json();case 401:throw Error("No authorization");default:throw Error("Unknown error")}}))},w=Object(m.createAsyncThunk)("register",function(){var e=Object(O.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y=Object(m.createAsyncThunk)("login",function(){var e=Object(O.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),k=Object(m.createAsyncThunk)("logout",function(){var e=Object(O.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S=n(23),C=n(34),T=n(36),E=T.a.ul(r||(r=Object(C.a)(["\n  display: flex;\n  justify-content: flex-end;\n"]))),L=T.a.li(a||(a=Object(C.a)(["\n  padding: 20px 20px;\n  &:not(last-child) {\n    margin-right: 20px;\n  }\n"]))),q=n(2);function I(){var e=Object(u.e)(j.d),t=Object(u.e)(j.a),n=Object(u.e)(j.c),r=Object(u.d)();return Object(c.useEffect)((function(){t&&Object(S.a)(t)}),[t]),Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(b.a,{children:Object(q.jsxs)(E,{children:[!e&&Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(L,{children:Object(q.jsx)(d.b,{to:"register",children:"Register"})}),Object(q.jsx)(L,{children:Object(q.jsx)(d.b,{to:"login",children:"LogIn"})})]}),e&&Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)(L,{children:["Hello, ",e]}),Object(q.jsx)(L,{children:Object(q.jsx)(d.b,{to:"/",onClick:function(){r(k(n))},children:"LogOut"})})]})]})}),Object(q.jsx)(l.b,{})]})}var A=n(12),P=n(10),N=n(37);function z(){var e,t,n,r=Object(c.useState)(null!==(e=sessionStorage.getItem("email"))&&void 0!==e?e:""),a=Object(P.a)(r,2),o=a[0],i=a[1],s=Object(c.useState)(""),d=Object(P.a)(s,2),O=d[0],h=d[1],f=Object(N.a)(),m=f.register,p=f.handleSubmit,g=f.formState.errors,v=Object(l.h)(),x=Object(u.d)(),w=Object(u.e)(j.b),k=Object(u.e)(j.a),C=Object(u.e)(j.d),T=function(e){var t=e.target.value;switch(e.target.name){case"email":i(t),sessionStorage.setItem("email",t);break;case"password":h(t);break;default:return}};return Object(c.useEffect)((function(){k&&Object(S.a)(k)}),[k]),Object(c.useEffect)((function(){C&&v("/contacts")}),[C,v]),Object(q.jsxs)(b.a,{children:[Object(q.jsx)("h2",{children:"Form Login"}),w&&Object(q.jsx)("h3",{children:"Loading...."}),Object(q.jsxs)("form",{onSubmit:p((function(e){x(y({email:"testtast4@gmail.com",password:"qwert-11"})),i(""),h(""),sessionStorage.removeItem("email")})),children:[Object(q.jsxs)("label",{children:["email",Object(q.jsx)("input",Object(A.a)(Object(A.a)({type:"email"},m("email",{required:!0})),{},{onChange:T,value:o})),"required"===(null===(t=g.email)||void 0===t?void 0:t.type)&&"Email is required"]}),Object(q.jsxs)("label",{children:["password",Object(q.jsx)("input",Object(A.a)(Object(A.a)({type:"password"},m("password",{required:!0})),{},{onChange:T,value:O})),"required"===(null===(n=g.password)||void 0===n?void 0:n.type)&&"Password is required"]}),Object(q.jsx)("button",{type:"button",onClick:function(){sessionStorage.removeItem("email"),v("/")},children:"Cancel"}),Object(q.jsx)("button",{type:"submit",children:"Log in"})]})]})}function B(){return Object(q.jsx)(z,{})}function _(){var e,t,n,r,a=Object(c.useState)(null!==(e=sessionStorage.getItem("name"))&&void 0!==e?e:""),o=Object(P.a)(a,2),i=o[0],s=o[1],d=Object(c.useState)(null!==(t=sessionStorage.getItem("email"))&&void 0!==t?t:""),O=Object(P.a)(d,2),h=O[0],f=O[1],m=Object(c.useState)(""),p=Object(P.a)(m,2),g=p[0],v=p[1],x=Object(N.a)(),y=x.register,k=x.handleSubmit,C=x.formState.errors,T=Object(l.h)(),E=Object(u.d)(),L=Object(u.e)(j.b),I=Object(u.e)(j.a),z=function(e){var t=e.target.value;switch(e.target.name){case"name":s(t),sessionStorage.setItem("name",t);break;case"email":f(t),sessionStorage.setItem("email",t);break;case"password":v(t);break;default:return}};return Object(c.useEffect)((function(){I&&Object(S.a)(I)}),[I]),Object(q.jsxs)(b.a,{children:[Object(q.jsx)("h2",{children:"Form Register"}),L&&Object(q.jsx)("h3",{children:"Loading...."}),Object(q.jsxs)("form",{onSubmit:k((function(e){E(w({name:"TestTest3",email:"testtast4@gmail.com",password:"qwert-11"})),s(""),f(""),v(""),sessionStorage.removeItem("name"),sessionStorage.removeItem("email")})),children:[Object(q.jsxs)("label",{children:["name",Object(q.jsx)("input",Object(A.a)(Object(A.a)({},y("name")),{},{value:i,onChange:z}))]}),Object(q.jsxs)("label",{children:["email",Object(q.jsx)("input",Object(A.a)(Object(A.a)({type:"email"},y("email",{required:!0})),{},{onChange:z,value:h})),"required"===(null===(n=C.email)||void 0===n?void 0:n.type)&&"Email is required"]}),Object(q.jsxs)("label",{children:["password",Object(q.jsx)("input",Object(A.a)(Object(A.a)({type:"password"},y("password",{required:!0})),{},{onChange:z,value:g})),"required"===(null===(r=C.password)||void 0===r?void 0:r.type)&&"Password is required"]}),Object(q.jsx)("button",{type:"button",onClick:function(){sessionStorage.removeItem("name"),sessionStorage.removeItem("email"),T("/")},children:"Cancel"}),Object(q.jsx)("button",{type:"submit",children:"Register"})]})]})}var F=Object(c.lazy)((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,101))}));function R(){return Object(q.jsx)("div",{className:"App",children:Object(q.jsx)(c.Suspense,{fallback:Object(q.jsx)("p",{children:"Loading...."}),children:Object(q.jsxs)(l.e,{children:[Object(q.jsxs)(l.c,{path:"/",element:Object(q.jsx)(I,{}),children:[Object(q.jsx)(l.c,{path:"login",element:Object(q.jsx)(B,{})}),Object(q.jsx)(l.c,{path:"register",element:Object(q.jsx)(_,{})}),Object(q.jsx)(l.c,{path:"contacts",element:Object(q.jsx)(F,{})})]}),Object(q.jsx)(l.c,{path:"*",element:Object(q.jsx)(l.a,{to:"/"})})]})})})}var J,M=n(8),H=n(7),U=n(49),W=n(40),D=n(47),Q=n.n(D),G=(n(67),n(33)),Y=n(44),K=Object(m.createReducer)("",Object(M.a)({},Y.a,(function(e,t){return t.payload})));console.log([w.pending]);var V,X=Object(m.createReducer)({name:"",email:"",token:"",error:"",isLoading:!1},(J={},Object(M.a)(J,w.pending,(function(e,t){e.isLoading=!0,e.error=""})),Object(M.a)(J,w.fulfilled,(function(e,t){var n=t.payload;e.token=n.token,e.name=n.user.name,e.email=n.user.email,e.error="",e.isLoading=!1})),Object(M.a)(J,w.rejected,(function(e,t){var n=t.error;e.error=n.message,e.isLoading=!1})),Object(M.a)(J,y.pending,(function(e,t){e.isLoading=!0,e.error=""})),Object(M.a)(J,y.fulfilled,(function(e,t){var n=t.payload;e.token=n.token,e.name=n.user.name,e.email=n.user.email,e.error="",e.isLoading=!1})),Object(M.a)(J,y.rejected,(function(e,t){var n=t.error;e.error=n.message,e.isLoading=!1})),Object(M.a)(J,k.pending,(function(e,t){e.isLoading=!0,e.error=""})),Object(M.a)(J,k.fulfilled,(function(e,t){t.payload;e.token="",e.name="",e.email="",e.error="",e.isLoading=!1})),Object(M.a)(J,k.rejected,(function(e,t){var n=t.error;e.error=n.message,e.isLoading=!1})),J)),Z={key:"root",storage:Q.a,whitelist:["token","name","email"]},$=Object(W.a)(Z,X),ee=Object(m.configureStore)({reducer:(V={users:$},Object(M.a)(V,G.a.reducerPath,G.a.reducer),Object(M.a)(V,"filter",K),V),middleware:function(e){return[].concat(Object(H.a)(e()),[G.a.middleware,!1])},devTools:!1});Object(U.setupListeners)(ee.dispatch);var te=Object(W.b)(ee),ne=n(28),re=(n(70),n(50));s.a.render(Object(q.jsx)(o.a.StrictMode,{children:Object(q.jsx)(u.a,{store:ee,children:Object(q.jsxs)(re.a,{loader:null,persistor:te,children:[Object(q.jsx)(d.a,{children:Object(q.jsx)(R,{})}),Object(q.jsx)(ne.a,{})]})})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.22b99207.chunk.js.map